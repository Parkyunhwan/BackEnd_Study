# 관계형 데이터베이스

키와 값을 관계로 묶어 테이블 형태로 저장하는 것

데이터 항목은 각 행에 저장되고 속성은 열에 표현된다.

관계형 데이터베스에서 "관계"란 각 테이블의 행과 행이 연결되는 관계를 맺을 수 있기 때문이다.

이러한 관계가 생기는 이유는

하나의 테이블의 모든 정보를 넣으면 하나의 튜플에 중복되는 속성 값이 많아지기 때문이다.

이러한 중복은 삽입, 갱신, 삭제 이상현상의 원인이 된다.

이상 현상을 해결하기 위해 테이블 간의 관계를 (기본키, 외래키)를 이용해서 정의하거나 테이블을 분리해서 사용할 수 있다.

# 데이터베이스 제어 기법

### 동시성 제어 기법

다중 사용자 환경을 지원하는 DB 시스템에서
여러 트랜잭션이 동시에 데이터베이스의 일관성을 파괴하지 않고 성공적으로 실행될 수 있도록 트랜잭션 간의 상호작용을 제어한다.

- 목적

    데이터베이스는 트랜잭션을 관리하며 응답시간, 공유, 무결성, 일관성을 위해 동시성 제어를 사용한다.

동시성 제어를 하지 않을 경우 생기는 문제는

- 갱신 내용 손실
    - 갱신한 데이터가 다른 트랜잭션에 의해 변경됨

- 현황 파악 오류
    - 아직 커밋되지 않은 데이터를 읽고 데이터를 변경한 트랜잭션이 롤백되면 오류가 발생됨

- 연쇄 복귀, 회복 불능
    - 다른 트랜잭션의 수행으로 인해 트랜잭션의 취소가 불가능한 상태

이러한 문제를 해결하기 위한 기법은

- 잠금(Locking)
    - 확장 - 차단 - 수축
        - 트랜잭션 lock 획득 → 데이터 연산 수행 → 트랜잭션 lock 반납
        - 직렬성을 보장하지만 교착상태를 예방할 수 없다.

- 타임 스탬프 방식
    - 트랜잭션 간의 처리 순서를 미리 선택하는 기법
    - 교착 상태가 발생하지 않는다.

- 검증 방식
    - 데이터 연산 수행 후 직렬성이 확인 되면 commit 실패 시 rollback

- 다중 버전
    - 성공한 트랜잭션의 최종 버전을 DBMS에 반영

## DDL (Data Definition Language) 데이터 정의어

> 데이터, 제약조건을 생성하거나 수정, 삭제 등 데이터의 전체 구조를 결정하는 역할의 언어

SCHEMA, DOMAIN, TABLE, VIEW, INDEX를 정의하거나 변경 또는 삭제할 때 사용

- CREATE
    - 데이터베이스, 테이블 등을 생성
- ALTER
    - 테이블 구조, 제약조건을 수정하는 역할
- DROP
    - 데이터베이스, 테이블을 삭제하는 역할
- TRUNCATE
    - 테이블을 초기화 시키는 역할

## DML (Data Manipulation Language) 데이터 조작어

> 데이터베이스의 레코드를 조회, 수정, 삭제하는 역할

- SELECT, INSERT, UPDATE, DELETE
    - 데이터 조회, 삽입, 수정, 삭제

## DCL (Data Contorl Language) 데이터 제어어

> 데이터베이스에 접근하거나 객체에 권한을 주는 등의 역할

→ 데이터를 제어하는 언어이며 데이터의 보안, 무결성, 회복등을 정의한다.

- GRANT
    - 특정 데이터베이스 사용자에게 특정 작업에 대한 권한을 부여
- REVOKE
    - 특정 데이터베이스 사용자에게 부여한 권한을 박탈 한다.
- COMMIT
    - 트랜잭션의 작업이 정상적으로 완료되었음을 관리자에게 알린다.
- ROLLBACK
    - 트랜잭션 작업 진행 중 오류 발생 시 진행한 작업을 취소하고 원래의 상태로 복구한다.

# 프로세스 vs 쓰레드

- 프로그램
    - 실행할 수 있는 파일

### 프로세스란?

- **메모리에 올라와서 실행되고 있는 프로그램의 인스턴스**
- 운영체제로 부터 **시스템 자원을 할당받는 작업의 단위**
    - 할당받는 자원 : CPU 타임, [Code, Data, Stack, Heap]으로 구성된 메모리 영역
- 기본적으로 프로세스당 최소 1개의 쓰레드를 가짐

각 프로세스는 서로 독립적인 주소 공간에서 실행되므로 다른 프로세스의 변수 또는 자료구조에 접근할 수 없다. 한 프로세스가 다른 프로세스에 접근하기 위해선 IPC(Inter-Process-Communication)을 사용해야만 한다.

### 쓰레드란?

- 프로세스 내에서 실행되는 **여러 흐름의 단위**
- 프로세스가 할당받은 자원을 이용하는 실행의 단위

- 특징
    - 쓰레드는 프로세스 내의 Code, Data, Heap영역은 공유하고 Stack영역만 따로 할당받아 사용한다.
    - 쓰레드는 프로세스 내에서 여러 흐름이 실행되는 것이므로 프로세스 내 자원을 서로 공유하며 실행할 수 있다.
    - 각각의 쓰레드는 별도의 레지스터와 스택을 가진다.

- 자바 쓰레드??
    - 자바에는 프로세스가 존재하지 않는다.
    - 일반 쓰레드와 별차이가 없으며 JVM이 운영체제 역할을 하며 JVM에 의해 스케줄되는 실행 단위이다.

# 쿠키와 세션

### 쿠키

> 사용자가 사이트를 방문할 때 브라우저에 저장되는 정보

- 쿠키는 임의로 수정이 가능하고 삭제가 가능하므로 **중요한 정보를 담기에는 부적절함.**
- 사용자 인증이 유효한 시간을 명시할 수 있으며, 브라우저가 종료되어도 인증이 유지됨.

쿠키의 구성요소

→ 쿠키 이름, 값, 유효시간, 도메인, 경로

- 쿠키의 동작 방식
    1. 클라이언트가 서버에 요청
    2. 서버에서 '쿠키'를 생성
    3. HTTP 헤더에 쿠키와 함께 응답
    4. 브라우저에 쿠키를 인증 유효시간까지 저장
    5. 브라우저는 같은 요청 시 헤더에 쿠키를 실어보내 서버에서 '쿠키'에 대응되는 정보를 가져와 응답을 하게 함

### 세션

> 서버측에서 클라이언트가 브라우저를 종료할 때까지 유지하는 관리 정보

- 클라이언트가 브라우저 종료 할때까지 유지됨 (응답 시간 제한을 둘 수도 있음)
- 정보를 서버에 두기에 **보안이 좋지만** 사용자가 많아지면 **서버 메모리도 많이 사용함**

- 세션의 동작 방식
    1. 클라이언트가 서버에 접속 시 세션ID를 발급 받음
    2. 클라이언트는 세션 ID에 대한 쿠키를 받아서 브라우저에 저장
    3. 클라이언트는 서버에 요청 시 이 쿠키를 함께 보냄
    4. 서버는 쿠키에 대응되는 세션에서 클라이언트 정보를 가져옴
    5. 서버는 클라이언트 정보를 가지고 요청을 처리하여 클라이언트에 응답

### 쿠키와 세션의 차이

- 세션은 서버의 자원을 사용하며 쿠키는 서버의 자원을 사용하지 않는다.
- 보안은 세션이 뛰어나고 속도는 쿠기가 빠르다.
- 쿠키는 브라우저 종료와 상관없이 유효기간 까지 유지되지만 세션은 브라우저 종료 시 삭제된다.

세션을 많이 사용하면 보안성이 좋아지지만 서버의 메모리를 많이 사용해 서버의 성능이 하락할 수 있으므로 쿠키와 세션을 적절하게 사용해야 한다.
